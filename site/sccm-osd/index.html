
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="My docs" name="description"/>
<meta content="Daniel Beilin" name="author"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.1, mkdocs-material-8.5.7" name="generator"/>
<title>Add a device to a collection during OSD - Beinish</title>
<link href="../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<meta content="#4051b5" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="indigo" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#how-it-can-be-used">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Beinish" class="md-header__button md-logo" data-md-component="logo" href=".." title="Beinish">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Beinish
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Add a device to a collection during OSD
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Beinish/beinish-blog" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Beinish/beinish-blog
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../direnv/">
        General
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../ssm-patch-group/">
        AWS
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../pandas-delta/">
        Python
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../consolidation-alert/">
        PowerShell
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../client-cache/">
        SCCM
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../2020/">
        My Projects
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../about/">
      About
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Beinish" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Beinish">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Beinish
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Beinish/beinish-blog" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Beinish/beinish-blog
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          General
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="General" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          General
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../direnv/">
        Switch Between AWS Credentials With Direnv
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          AWS
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="AWS" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          AWS
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../ssm-patch-group/">
        Add Multiple Instances To a Patch Group in SSM
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          Python
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Python" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Python
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../pandas-delta/">
        Pandas – Get delta of two dates
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
          PowerShell
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="PowerShell" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          PowerShell
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../consolidation-alert/">
        Send An Alert If a VM Needs Consolidation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../automatic-dns/">
        Automatically Add Multiple DNS A Records
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../shutdown-delete/">
        Shutdown and Delete Multiple VMs Automatically
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../static-ip/">
        Automatically set a static IP for multiple hosts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../csv-to-dg/">
        Add Users From a CSV to a Distribution Group with PowerShell
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
          SCCM
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="SCCM" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          SCCM
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../client-cache/">
        Resize or Clear Client Cache
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Add a device to a collection during OSD
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Add a device to a collection during OSD
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-it-can-be-used">
    How it can be used
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sccm-vs/">
        Deploy Visual Studio 2017 with SCCM
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
          My Projects
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="My Projects" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          My Projects
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../2020/">
        TwentyTwenty – My First PyQt GUI App
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vm-cloner/">
        VM Cloner
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../about/">
        About
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/Beinish/beinish-blog/edit/master/docs/sccm-osd.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1>Add a device to a collection during OSD</h1>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd1.png"><img alt="" src="../images/sccm/osd1.png"/></a></p>
<p>If you’re looking to organize new computers that you deploy, then this might be helpful.</p>
<p>First, save the following code as <code>AddMeToCollection.vbs</code></p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>'==========================================================================
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a> '
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a> ' NAME: AddMeToCollection.vbs
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a> ' 
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a> ' AUTHOR: Vinay, Microsoft
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a> ' DATE  : 8/7/2010
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a> '
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a> ' COMMENT: Script to add Unknown Computer to a specified collection during OSD
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a> ' USAGE: cscript AddMeToCollection.vbs   %_SMSTSClientIdentity%
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a> '==========================================================================
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a> On Error Resume Next
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a> Dim arrArguments
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a> Set arrArguments = WScript.Arguments
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a> If arrArguments.Count &lt;&gt; 3 Then
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>     WScript.Echo "Usage: cscript AddMeToCollection.vbs   %_SMSTSClientIdentity%"
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>     WScript.Echo " and  needs to be specified, but last parameter needs to be used as is."
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>     WScript.Quit
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a> End If
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a> Dim strServer, strCollID, strProvNamespace
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a> Dim strComputerName, strGUID, strResourceID
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a> Dim strUser, strPassword
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a> strResourceID = 0
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a> strServer = arrArguments(0)
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a> strCollID = arrArguments(1)
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a> strGUID = arrArguments(2)
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a> WScript.Echo ""
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a> WScript.Echo "==================================="
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a> WScript.Echo "   ADDING COMPUTER TO COLLECTION"
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a> WScript.Echo "==================================="
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a> WScript.Echo "Site Server specified: " &amp; strServer
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a> WScript.Echo "Collection ID specified: " &amp; strCollID
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a> WScript.Echo "SMS Client " &amp; strGUID
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a> 'Get the computer name
<a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a> Set oNet = CreateObject("WScript.Network")
<a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a> strComputerName = oNet.ComputerName
<a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a> WScript.Echo "Computer Name: " &amp; strComputerName
<a href="#__codelineno-0-37" id="__codelineno-0-37" name="__codelineno-0-37"></a> Set oNet = Nothing
<a href="#__codelineno-0-38" id="__codelineno-0-38" name="__codelineno-0-38"></a> 'Connect to root/sms namespace on SMS Site Server to find the Provider Namespace
<a href="#__codelineno-0-39" id="__codelineno-0-39" name="__codelineno-0-39"></a> Set objLocator = CreateObject("WbemScripting.SWbemLocator")    
<a href="#__codelineno-0-40" id="__codelineno-0-40" name="__codelineno-0-40"></a> Set oWbem = objLocator.ConnectServer(strServer, "root/sms")  
<a href="#__codelineno-0-41" id="__codelineno-0-41" name="__codelineno-0-41"></a> If Err.number &lt;&gt; 0 Then
<a href="#__codelineno-0-42" id="__codelineno-0-42" name="__codelineno-0-42"></a>     WScript.Echo "Error connecting to root\sms namespace to find Provider Location. Exiting!"
<a href="#__codelineno-0-43" id="__codelineno-0-43" name="__codelineno-0-43"></a>     WScript.Echo "Error = " &amp; Err.number &amp; " - " &amp; Err.Description
<a href="#__codelineno-0-44" id="__codelineno-0-44" name="__codelineno-0-44"></a>     WScript.Quit
<a href="#__codelineno-0-45" id="__codelineno-0-45" name="__codelineno-0-45"></a> End If
<a href="#__codelineno-0-46" id="__codelineno-0-46" name="__codelineno-0-46"></a> Set colNameSpace = oWbem.ExecQuery("SELECT * FROM SMS_ProviderLocation")
<a href="#__codelineno-0-47" id="__codelineno-0-47" name="__codelineno-0-47"></a> For Each item in colNameSpace
<a href="#__codelineno-0-48" id="__codelineno-0-48" name="__codelineno-0-48"></a>        WScript.Echo "SMS Provider Namespace = " &amp; item.NamespacePath
<a href="#__codelineno-0-49" id="__codelineno-0-49" name="__codelineno-0-49"></a>     strProvNamespace = item.NamespacePath
<a href="#__codelineno-0-50" id="__codelineno-0-50" name="__codelineno-0-50"></a> Next
<a href="#__codelineno-0-51" id="__codelineno-0-51" name="__codelineno-0-51"></a> 'Connect to the Provider Namespace
<a href="#__codelineno-0-52" id="__codelineno-0-52" name="__codelineno-0-52"></a> Set oWbem = objLocator.ConnectServer(strServer, strProvNamespace)
<a href="#__codelineno-0-53" id="__codelineno-0-53" name="__codelineno-0-53"></a> If Err.number &lt;&gt; 0 Then
<a href="#__codelineno-0-54" id="__codelineno-0-54" name="__codelineno-0-54"></a>     WScript.Echo "Error connecting to SMS Provider namespace. Exiting!"
<a href="#__codelineno-0-55" id="__codelineno-0-55" name="__codelineno-0-55"></a>     WScript.Echo "Error = " &amp; Err.number &amp; " - " &amp; Err.Description
<a href="#__codelineno-0-56" id="__codelineno-0-56" name="__codelineno-0-56"></a>     WScript.Quit
<a href="#__codelineno-0-57" id="__codelineno-0-57" name="__codelineno-0-57"></a> Else
<a href="#__codelineno-0-58" id="__codelineno-0-58" name="__codelineno-0-58"></a>     WScript.Echo "Successfully Connected to the SMS Provider Namespace"
<a href="#__codelineno-0-59" id="__codelineno-0-59" name="__codelineno-0-59"></a> End If
<a href="#__codelineno-0-60" id="__codelineno-0-60" name="__codelineno-0-60"></a> 'Find out the Resource ID of the computer by querying SMS_R_System Class against the SMS GUID
<a href="#__codelineno-0-61" id="__codelineno-0-61" name="__codelineno-0-61"></a> Set colResources = oWbem.ExecQuery("SELECT ResourceID FROM SMS_R_System WHERE SMSUniqueIdentifier = '" &amp; strGUID &amp; "'")
<a href="#__codelineno-0-62" id="__codelineno-0-62" name="__codelineno-0-62"></a> For Each oResource In colResources
<a href="#__codelineno-0-63" id="__codelineno-0-63" name="__codelineno-0-63"></a>     strResourceID = oResource.ResourceID
<a href="#__codelineno-0-64" id="__codelineno-0-64" name="__codelineno-0-64"></a>     WScript.Echo "Resource ID = " &amp; strResourceID
<a href="#__codelineno-0-65" id="__codelineno-0-65" name="__codelineno-0-65"></a> Next
<a href="#__codelineno-0-66" id="__codelineno-0-66" name="__codelineno-0-66"></a> 'If Resource ID was not found, exit gracefully
<a href="#__codelineno-0-67" id="__codelineno-0-67" name="__codelineno-0-67"></a> If strResourceID = 0 Then
<a href="#__codelineno-0-68" id="__codelineno-0-68" name="__codelineno-0-68"></a>     WScript.Echo "Could not find the Resource ID for the computer. Exiting!"
<a href="#__codelineno-0-69" id="__codelineno-0-69" name="__codelineno-0-69"></a>     WScript.Quit
<a href="#__codelineno-0-70" id="__codelineno-0-70" name="__codelineno-0-70"></a> End If
<a href="#__codelineno-0-71" id="__codelineno-0-71" name="__codelineno-0-71"></a> 'Verify if the specified collection exists
<a href="#__codelineno-0-72" id="__codelineno-0-72" name="__codelineno-0-72"></a> Set oCollection = oWbem.Get("SMS_Collection.CollectionID=" &amp; """" &amp; strCollID &amp; """")
<a href="#__codelineno-0-73" id="__codelineno-0-73" name="__codelineno-0-73"></a> If oCollection.Name = "" Then
<a href="#__codelineno-0-74" id="__codelineno-0-74" name="__codelineno-0-74"></a>     WScript.Echo "Specified Collection (" &amp; strCollID &amp; ") was Not Found. Exiting!"
<a href="#__codelineno-0-75" id="__codelineno-0-75" name="__codelineno-0-75"></a>     WScript.Quit
<a href="#__codelineno-0-76" id="__codelineno-0-76" name="__codelineno-0-76"></a> End If
<a href="#__codelineno-0-77" id="__codelineno-0-77" name="__codelineno-0-77"></a> 'Create a Direct Membership rule
<a href="#__codelineno-0-78" id="__codelineno-0-78" name="__codelineno-0-78"></a> Set oDirectRule = oWbem.Get("SMS_CollectionRuleDirect").SpawnInstance_ ()
<a href="#__codelineno-0-79" id="__codelineno-0-79" name="__codelineno-0-79"></a> oDirectRule.ResourceClassName = "SMS_R_System"
<a href="#__codelineno-0-80" id="__codelineno-0-80" name="__codelineno-0-80"></a> oDirectRule.ResourceID = strResourceID
<a href="#__codelineno-0-81" id="__codelineno-0-81" name="__codelineno-0-81"></a> oDirectRule.RuleName = strComputerName &amp; " - SMSTS"
<a href="#__codelineno-0-82" id="__codelineno-0-82" name="__codelineno-0-82"></a> 'Add the Direct Membership Rule to the specified collection
<a href="#__codelineno-0-83" id="__codelineno-0-83" name="__codelineno-0-83"></a> oCollection.AddMembershipRule oDirectRule
<a href="#__codelineno-0-84" id="__codelineno-0-84" name="__codelineno-0-84"></a> If Err.Number &lt;&gt; 0 Then
<a href="#__codelineno-0-85" id="__codelineno-0-85" name="__codelineno-0-85"></a>     WScript.Echo "Could not add the computer to the specified collection. Exiting!"
<a href="#__codelineno-0-86" id="__codelineno-0-86" name="__codelineno-0-86"></a>     WScript.Echo "Error = " &amp; Err.number &amp; " - " &amp; Err.Description
<a href="#__codelineno-0-87" id="__codelineno-0-87" name="__codelineno-0-87"></a>     WScript.Quit
<a href="#__codelineno-0-88" id="__codelineno-0-88" name="__codelineno-0-88"></a> Else
<a href="#__codelineno-0-89" id="__codelineno-0-89" name="__codelineno-0-89"></a>     WScript.Echo strComputerName &amp; " successfully added To " &amp; strCollID
<a href="#__codelineno-0-90" id="__codelineno-0-90" name="__codelineno-0-90"></a> End If
<a href="#__codelineno-0-91" id="__codelineno-0-91" name="__codelineno-0-91"></a> WScript.Echo "==================================="
<a href="#__codelineno-0-92" id="__codelineno-0-92" name="__codelineno-0-92"></a> WScript.Echo ""
<a href="#__codelineno-0-93" id="__codelineno-0-93" name="__codelineno-0-93"></a> Set objLocator = Nothing
<a href="#__codelineno-0-94" id="__codelineno-0-94" name="__codelineno-0-94"></a> Set oWbem = Nothing
<a href="#__codelineno-0-95" id="__codelineno-0-95" name="__codelineno-0-95"></a> Set oCollection = Nothing
<a href="#__codelineno-0-96" id="__codelineno-0-96" name="__codelineno-0-96"></a> Set oDirectRule = Nothing
<a href="#__codelineno-0-97" id="__codelineno-0-97" name="__codelineno-0-97"></a> 'End Script
</code></pre></div>
<p>Move it to a folder in your SCCM server and create a new package.</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd2.png"><img alt="" src="../images/sccm/osd2.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd3.png"><img alt="" src="../images/sccm/osd3.png"/></a></p>
<p>Now go to your Task Sequence and add a command line</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd4.png"><img alt="" src="../images/sccm/osd4.png"/></a></p>
<p>Add the following command:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>cscript AddMeToCollection.vbs sccm.server.com XX100028 %_SMSTSClientIdentity%
</code></pre></div></p>
<ul>
<li>Where <code>sccm.server.com</code> is, replace it with your SCCM server.</li>
<li>For <code>XX1000E1</code>, replace it with the collection’s ID.</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd5.png"><img alt="" src="../images/sccm/osd5.png"/></a></p>
<p>I personally had to use a privileged account for it to work. I apply this after the client is installed, and from my testing, it failed without admin rights. As always, your mileage may vary.</p>
<h3 id="how-it-can-be-used">How it can be used</h3>
<p>This script can be super useful in environments where you deploy all kinds of image versions for different departments. For example, I use TsGui and created an XML GUI to choose which customization to apply to the image using variables.
This script helped me add the device I’m imaging to the correct collection because I configure each department separately, as can be seen here:</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd6.png"><img alt="" src="../images/sccm/osd6.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/sccm/osd7.png"><img alt="" src="../images/sccm/osd7.png"/></a></p>
<details class="note" open="open">
<summary>Note</summary>
<p>In my environment, the new device appears as “Unknown” fora while (15-30 minutes) but eventually gets the correct hostname.</p>
</details>
<p>Hope this has been useful to you 🙂</p>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Resize or Clear Client Cache" class="md-footer__link md-footer__link--prev" href="../client-cache/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Resize or Clear Client Cache
            </div>
</div>
</a>
<a aria-label="Next: Deploy Visual Studio 2017 with SCCM" class="md-footer__link md-footer__link--next" href="../sccm-vs/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Deploy Visual Studio 2017 with SCCM
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2022 Daniel Beilin
    </div>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/Beinish" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/in/daniel-beilin/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.tabs", "navigation.expand", "navigation.top", "toc.integrate", "content.code.annotate", "content.tabs.link"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.8492ddcf.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body>
</html>